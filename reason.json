{
  "scopeName": "source.reason",
  "fileTypes": [
    "re"
  ],
  "patterns": [
    { "include": "#module-items" },
    { "include": "#module-type-items" }
  ],
  "repository": {
    "comment": {
      "patterns": [
        {
          "contentName": "comment.block.reason",
          "begin": "\\s*+((/\\*))",
          "end": "(\\s*(\\*/))",
          "captures": {
            "1": { "name": "comment.block.reason" },
            "2": { "name": "punctuation.definition.comment.reason" }
          }
        }
      ]
    },
    "identifier-constructor": {
      "comment": "FIXME",
      "name": "constant.language.constructor.reason",
      "match": "\\b([A-Z]+[[:word:]]*)\\b(?![[:space:]]*\\.)"
    },
    "identifier-module": {
      "name": "entity.name.class.reason",
      "match": "\\b([A-Z]+[[:word:]]*)\\b"
    },
    "identifier-type": {
      "name": "entity.name.function.reason",
      "match": "(?<!')\\b([a-z][[:word:]]*)\\b"
    },
    "item-let-decl": {
      "begin": "\\b(let)\\b",
      "end": ";",
      "beginCaptures": {
        "1": { "name": "storage.type.let.reason" }
      },
      "patterns": [
      ]
    },
    "item-let-defn": {
      "begin": "\\b(let)\\b",
      "end": ";",
      "beginCaptures": {
        "1": { "name": "storage.type.let.reason" }
      },
      "patterns": [
        { "include": "#item-let-module-defn" },
        { "include": "#item-let-rec-val-defn" },
        { "include": "#item-let-val-defn" }
      ]
    },
    "item-let-module-defn": {
      "begin": "\\b(module)\\b",
      "end": "(?=;)",
      "beginCaptures": {
        "1": { "name": "storage.type.module.reason" }
      },
      "patterns": [
        { "include": "#item-let-module-defn-0" },
        { "include": "#item-let-module-defn-1" },
        { "include": "#item-let-module-defn-2" },
        { "include": "#comment" }
      ]
    },
    "item-let-module-defn-0": {
      "begin": "\\b([A-Z]+[[:word:]]*)\\b",
      "end": "(?=:|=)",
      "beginCaptures": {
        "1": { "name": "entity.name.class.module.reason" }
      },
      "patterns": [
        { "include": "#comment" }
      ]
    },
    "item-let-module-defn-1": {
      "begin": ":",
      "end": "(?==)",
      "patterns": [
        {
          "begin": "{",
          "end": "}",
          "beginCaptures": {
            "0": { "name": "meta.brace.curly.reason" }
          },
          "endCaptures": {
            "0": { "name": "meta.brace.curly.reason" }
          },
          "patterns": [
            { "include": "#module-type-items" }
          ]
        }
      ]
    },
    "item-let-module-defn-2": {
      "begin": "=",
      "end": "(?=;)",
      "patterns": [
        {
          "begin": "{",
          "end": "}",
          "beginCaptures": {
            "0": { "name": "meta.brace.curly.reason" }
          },
          "endCaptures": {
            "0": { "name": "meta.brace.curly.reason" }
          },
          "patterns": [
            { "include": "source.reason" }
          ]
        }
      ]
    },
    "item-let-rec-val-defn": {
      "begin": "\\b(rec)\\b",
      "end": "(?=;)",
      "beginCaptures": {
        "1": { "name": "storage.modifier.rec.reason" }
      },
      "patterns": [
        { "include": "#item-let-val-defn" }
      ]
    },
    "item-let-val-defn": {
      "patterns": []
    },
    "item-module-type-defn": {
      "begin": "\\b(module)\\b",
      "end": ";",
      "beginCaptures": {
        "1": { "name": "storage.type.module.reason" }
      },
      "patterns": [
        { "include": "#item-module-type-defn-0" },
        { "include": "#item-module-type-defn-1" }
      ]
    },
    "item-module-type-defn-0": {
      "begin": "\\b(type)\\b",
      "end": "(?==)",
      "beginCaptures": {
        "1": { "name": "keyword.other.type.reason" }
      },
      "patterns": [
        { "include": "#identifier-module" }
      ]
    },
    "item-module-type-defn-1": {
      "begin": "=",
      "end": "(?=;)",
      "patterns": [
        {
          "begin": "{",
          "end": "}",
          "patterns": [
            { "include": "#module-type-items" }
          ]
        }
      ]
    },
    "item-open": {
      "begin": "\\b(open)\\b",
      "end": ";",
      "beginCaptures": {
        "0": { "name": "keyword.control.import.include.reason" }
      },
      "patterns": [
        { "include": "#identifier-module" }
      ]
    },
    "item-type-defn": {
      "name": "meta.type.reason",
      "begin": "(?=\\btype\\b)",
      "end": ";",
      "patterns": [
        { "include": "#item-type-defn-0" },
        { "include": "#item-type-defn-1" },
        { "include": "#item-type-defn-2" }
      ]
    },
    "item-type-defn-0": {
      "name": "meta.type.reason",
      "begin": "\\b(type)\\b",
      "end": "(?==)",
      "beginCaptures": {
        "1": { "name": "keyword.other.type.reason" }
      }
      ,
      "patterns": [
        { "include": "#identifier-type" }
      ]
    },
    "item-type-defn-1": {
      "begin": "=",
      "end": "(?=;|\\|)",
      "patterns": [
        { "include": "#identifier-constructor" },
        { "include": "#identifier-module" },
        { "include": "#identifier-type" }
      ]
    },
    "item-type-defn-2": {
      "begin": "\\|",
      "end": "(?=;|\\|)",
      "beginCaptures": {
        "0": { "name": "keyword.other.reason" }
      },
      "patterns": [
        { "include": "#identifier-constructor" },
        { "include": "#identifier-module" },
        { "include": "#identifier-type" }
      ]
    },
    "misc": {
      "patterns": [
        {
          "begin": "\"",
          "end": "\"|(?:[^\\\\\\n]$)",
          "name": "string.double.reason"
        },
        {
          "name": "keyword.control.reason",
          "match": "\\b(if|switch|when)\\b"
        },
        {
          "name": "storage.type.function.reason",
          "match": "\\b(fun)\\b"
        },
        {
          "name": "keyword.control.label.reason",
          "match": "::"
        }
      ]
    },
    "module-items": {
      "patterns": [
        { "include": "#item-let-defn" },
        { "include": "#item-module-type-defn" },
        { "include": "#item-open" },
        { "include": "#item-type-defn" },
        { "include": "#comment" },
        { "include": "#misc" }
      ]
    },
    "module-type-items": {
      "patterns": [
        { "include": "#item-let-decl" },
        { "include": "#item-open" },
        { "include": "#item-type-defn" },
        { "include": "#comment" },
        { "include": "#misc" }
      ]
    }
  }
}
